(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{427:function(t,s,a){"use strict";a.r(s);var e=a(2),r=Object(e.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h3",{attrs:{id:"构建electron-app"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#构建electron-app"}},[t._v("#")]),t._v(" 构建Electron App")]),t._v(" "),s("p",[t._v("之前我们介绍过Electron的搭建以及与系统交互的内容，当一个应用"),s("code",[t._v("逐渐完善")]),t._v("，肯定是得共享给他人使用的。")]),t._v(" "),s("p",[t._v("那么今天我们就来介绍一下Eelectron里面的打包工具: Electron-Builder")]),t._v(" "),s("h3",{attrs:{id:"electron的打包工具"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#electron的打包工具"}},[t._v("#")]),t._v(" Electron的打包工具")]),t._v(" "),s("p",[t._v("根据官网的指引，官方推荐了以下3款打包工具。我尝试了其中的2款，并成功打出了mac/windows双系统的app，并且测试了一番，感觉还不错。")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://static.pity.fun/picture/20220612164737.png",alt:""}})]),t._v(" "),s("ul",[s("li",[s("p",[t._v("electron-forge")])]),t._v(" "),s("li",[s("p",[t._v("electron-builder")])]),t._v(" "),s("li",[s("p",[t._v("electron-packager")]),t._v(" "),s("p",[t._v("对于forge，我看了一下近期更新的不是很频繁，甚至npm包版本还是beta版本")])])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://static.pity.fun/picture/20220612165001.png",alt:""}})]),t._v(" "),s("p",[s("code",[t._v("并且我根据文档来，还报了错，所以，我选择了electron-builder。")])]),t._v(" "),s("h3",{attrs:{id:"electron-builder"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#electron-builder"}},[t._v("#")]),t._v(" Electron Builder")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://www.electron.build/",target:"_blank",rel:"noopener noreferrer"}},[t._v("electron-builder"),s("OutboundLink")],1),t._v("官网的文档比较详细，而且配置也非常丰富。")]),t._v(" "),s("p",[t._v("由于官网的例子比较丰富，所以我这就只介绍最简单的使用场景了。")]),t._v(" "),s("h4",{attrs:{id:"打包umi项目"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#打包umi项目"}},[t._v("#")]),t._v(" 打包umi项目")]),t._v(" "),s("p",[t._v("我们需要先将umi项目构建，变为对应的静态资源（html/js/css)。")]),t._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# umi build")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" run build\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])]),s("h3",{attrs:{id:"改造package-json"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#改造package-json"}},[t._v("#")]),t._v(" 改造package.json")]),t._v(" "),s("p",[t._v("同样，package.json也需要进行一些适当的"),s("code",[t._v("调整")]),t._v("。主要是为了加入打包的配置数据:")]),t._v(" "),s("h4",{attrs:{id:"加入build参数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#加入build参数"}},[t._v("#")]),t._v(" 加入build参数")]),t._v(" "),s("div",{staticClass:"language-json line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"appId"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"pora"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"files"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"!**/node_modules/*"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"includeSubNodeModules"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"icon"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./logo.ico"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"mac"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"category"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"woody.app.pora"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"electronDownload"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"mirror"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://npm.taobao.org/mirrors/electron/"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br")])]),s("p",[t._v("我们一个个来看这些参数:")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("appId")]),t._v(" "),s("p",[t._v("构建的唯一标识")])]),t._v(" "),s("li",[s("p",[t._v("files")]),t._v(" "),s("p",[t._v("需要打包的文件列表，默认来说会打包所有，由于我们已经build好了，其实不太需要node_modules的数据，这里我们就"),s("code",[t._v("拒绝")]),t._v("打包node_modules的数据即可。")])]),t._v(" "),s("li",[s("p",[t._v("includeSubNodeModules")]),t._v(" "),s("p",[t._v("不打包子模块。")])]),t._v(" "),s("li",[s("p",[t._v("icon")]),t._v(" "),s("p",[t._v("这里值得注意的是，mac需要512x512的ico图标，mac支持png和ico等，windows需要ico文件。（都不支持svg）我是在线搜了个svg转ico的网站转换的。")])]),t._v(" "),s("li",[s("p",[t._v("mac")]),t._v(" "),s("p",[t._v("mac下独有的配置，我也不知道有没有啥用，主要是类似Java package的路径，标识app唯一路径的。")])]),t._v(" "),s("li",[s("p",[t._v("electronDownload")]),t._v(" "),s("p",[t._v("这配置可以加上，不然可能会被墙，过程中。")])])]),t._v(" "),s("h4",{attrs:{id:"加入scripts命令"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#加入scripts命令"}},[t._v("#")]),t._v(" 加入Scripts命令")]),t._v(" "),s("p",[t._v("我们把"),s("code",[t._v('"app:dist": "electron-builder",')]),t._v("加入到scripts。")]),t._v(" "),s("p",[t._v("最终效果如图所示:")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://static.pity.fun/picture/20220612170936.png",alt:""}})]),t._v(" "),s("p",[t._v("接着我们就可以开始下一步了。")]),t._v(" "),s("h3",{attrs:{id:"安装electron和electron-builder"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装electron和electron-builder"}},[t._v("#")]),t._v(" 安装electron和electron-builder")]),t._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" --save-dev electron\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" --save-dev electron-builder\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])]),s("p",[t._v("这里可以用yarn和cnpm，你们啥装得上就用啥。--save-dev是指调试环境使用。")]),t._v(" "),s("h3",{attrs:{id:"启动builder"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#启动builder"}},[t._v("#")]),t._v(" 启动builder")]),t._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("// cnpm run app:dist\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" run app:dist\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])]),s("p",[t._v("接着我们就可以启动npm命令，执行对应的操作了。稍等片刻，就可以得到dist目录, 注意，umi目录默认build输出的也是dist，我这里是改成了别的，所以2者没冲突。")]),t._v(" "),s("p",[t._v("大家可以参考下我这个项目: "),s("a",{attrs:{href:"https://github.com/wuranxu/pora",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/wuranxu/pora"),s("OutboundLink")],1)]),t._v(" "),s("p",[s("img",{attrs:{src:"https://static.pity.fun/picture/20220612171353.png",alt:""}})]),t._v(" "),s("p",[t._v("注意还得指定main.js的输出目录哈。")]),t._v(" "),s("h3",{attrs:{id:"看看打包后的内容"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#看看打包后的内容"}},[t._v("#")]),t._v(" 看看打包后的内容")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://static.pity.fun/picture/20220612171501.png",alt:""}})]),t._v(" "),s("p",[t._v("Windows下，默认会有安装版和绿色版，绿色版比较大，几乎裸的app就有100来MB，所以可以给安装版其他人用。")]),t._v(" "),s("p",[s("code",[t._v("注意安装版也是有很多配置的，我比较懒，这里就没写上，都是默认的。建议给出绿色版")])]),t._v(" "),s("p",[t._v("下面的dmg则是mac平台打包后，传到Windows这台机器来的，其实正常来讲不会生成dmg的哈。")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://static.pity.fun/picture/20220612171637.png",alt:""}})]),t._v(" "),s("p",[t._v("打开pora以后，然后我就得到了自己的轻量版本mdnice的markdown编辑器，做工"),s("code",[t._v("比较粗糙")]),t._v("，主要是自用为主。")]),t._v(" "),s("p",[t._v("欢迎大家一起探讨哈~有打包问题欢迎大家留言~~")])])}),[],!1,null,null,null);s.default=r.exports}}]);