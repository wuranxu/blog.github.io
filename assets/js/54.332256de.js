(window.webpackJsonp=window.webpackJsonp||[]).push([[54],{466:function(t,v,_){"use strict";_.r(v);var a=_(2),i=Object(a.a)({},(function(){var t=this,v=t._self._c;return v("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[v("blockquote",[v("p",[t._v("大家好~我是"),v("code",[t._v("米洛")]),t._v("！"),v("br"),t._v("\n我正在从0到1打造一个开源的接口测试平台, 也在编写一套与之对应的"),v("code",[t._v("教程")]),t._v("，希望大家多多支持。"),v("br"),t._v("\n欢迎关注我的公众号"),v("code",[t._v("米洛的测开日记")]),t._v("，获取最新文章教程!")])]),t._v(" "),v("h3",{attrs:{id:"回顾"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#回顾"}},[t._v("#")]),t._v(" 回顾")]),t._v(" "),v("p",[t._v("上一节我们完善了"),v("code",[t._v("操作记录")]),t._v("页面，这次我们来讲讲用户管理相关的功能。做这个的目的呢，主要是为了给"),v("code",[t._v("管理员")]),t._v("一个调整用户信息和权限的机会。比如封禁账号，开通"),v("code",[t._v("组长权限")]),t._v("的。")]),t._v(" "),v("h3",{attrs:{id:"说个题外话"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#说个题外话"}},[t._v("#")]),t._v(" 说个题外话")]),t._v(" "),v("p",[t._v("测试平台系列，满打满算，写到这儿已经有100节了。相信能跟随到这一节的朋友，已经对pity比较熟悉了，起码整体思路是没问题了。接下来我可能会不太详细强调实现，只会用思路+核心代码的方式来讲解。")]),t._v(" "),v("p",[v("strong",[t._v("针对我的细致改动，可以去看看github main分支的提交记录。")])]),t._v(" "),v("h3",{attrs:{id:"获取用户列表"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#获取用户列表"}},[t._v("#")]),t._v(" 获取用户列表")]),t._v(" "),v("p",[t._v("这个接口是我们已经有了的，所以我们不需要"),v("code",[t._v("额外编写")]),t._v("了，直接调用即可。")]),t._v(" "),v("h3",{attrs:{id:"更新用户信息"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#更新用户信息"}},[t._v("#")]),t._v(" 更新用户信息")]),t._v(" "),v("p",[t._v("因为上面我们说到了封禁用户，所以我们需要定义一个"),v("code",[t._v("is_valid")]),t._v("字段，当字段为True的时候，代表用户是正常的(没有被封禁)。")]),t._v(" "),v("p",[t._v("接着就很自然了，就是普通的"),v("code",[t._v("编辑功能")]),t._v("。")]),t._v(" "),v("ul",[v("li",[t._v("修改用户表")])]),t._v(" "),v("p",[v("img",{attrs:{src:"https://static.pity.fun/picture/2022-1-2/1641053650507-image.png",alt:""}})]),t._v(" "),v("p",[t._v("新增is_valid字段，默认值为True.")]),t._v(" "),v("ul",[v("li",[v("p",[t._v("新增编辑方法")]),t._v(" "),v("p",[t._v("在此之前我们要先定义好"),v("code",[t._v("请求参数")]),t._v(":")])])]),t._v(" "),v("p",[v("img",{attrs:{src:"https://static.pity.fun/picture/2022-1-2/1641053811285-image.png",alt:""}})]),t._v(" "),v("p",[t._v("参数接受能够改动的几个字段:")]),t._v(" "),v("ul",[v("li",[v("p",[t._v("id 确定用户")])]),t._v(" "),v("li",[v("p",[t._v("name 用户姓名")])]),t._v(" "),v("li",[v("p",[t._v("email 用户邮箱")])]),t._v(" "),v("li",[v("p",[t._v("role 用户角色")])]),t._v(" "),v("li",[v("p",[t._v("is_valid 是否封禁")]),t._v(" "),v("p",[t._v("目前我们只支持这些内容的修改，如果"),v("code",[t._v("前端不传入")]),t._v("或者传入空值，我们就不修改数据，所以除了id必填以外，其他都是可选的。")]),t._v(" "),v("p",[t._v("接着我们去编辑dao层的编辑方法:")])])]),t._v(" "),v("p",[v("img",{attrs:{src:"https://static.pity.fun/picture/2022-1-2/1641053936160-image.png",alt:"app/crud/auth/UserDao.py"}})]),t._v(" "),v("p",[t._v("内容也很简单，根据id查找到用户，如果不存在则"),v("code",[t._v("抛异常")]),t._v("。否则则更新数据中的非0字段。")]),t._v(" "),v("p",[v("strong",[t._v("注意这里还有个redis操作，因为我们改了数据的话，redis是需要删除的，不然查询接口还是用的旧数据")])]),t._v(" "),v("ul",[v("li",[t._v("编写接口")])]),t._v(" "),v("p",[v("img",{attrs:{src:"https://static.pity.fun/picture/2022-1-2/1641054070477-image.png",alt:""}})]),t._v(" "),v("p",[t._v("router往往都很简单，都是调用dao的方法即可。就不需要过多强调了。")]),t._v(" "),v("h3",{attrs:{id:"编写前端"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#编写前端"}},[t._v("#")]),t._v(" 编写前端")]),t._v(" "),v("p",[v("img",{attrs:{src:"https://static.pity.fun/picture/2022-1-2/1641054257618-image.png",alt:""}})]),t._v(" "),v("p",[t._v("前端比较简单，上下结构:")]),t._v(" "),v("ul",[v("li",[t._v("搜索框")]),t._v(" "),v("li",[t._v("用户表格")])]),t._v(" "),v("p",[v("img",{attrs:{src:"https://static.pity.fun/picture/2022-1-2/1641054358846-image.png",alt:""}})]),t._v(" "),v("p",[t._v("编辑的时候，自动带入用户数据原始值，点击确定按钮的时候调用刚才编写的"),v("code",[t._v("更新接口")]),t._v("即可。")]),t._v(" "),v("h3",{attrs:{id:"密码问题"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#密码问题"}},[t._v("#")]),t._v(" 密码问题")]),t._v(" "),v("p",[t._v("为什么不让管理员修改密码，因为我觉得管理员最多允许重置用户的密码，而不是直接掌控他人的密码。不然可能就毫无隐私可言了，也容易被人利用。")])])}),[],!1,null,null,null);v.default=i.exports}}]);