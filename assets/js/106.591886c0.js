(window.webpackJsonp=window.webpackJsonp||[]).push([[106],{518:function(t,r,a){"use strict";a.r(r);var s=a(2),_=Object(s.a)({},(function(){var t=this,r=t._self._c;return r("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[r("h2",{attrs:{id:"编写类postman页面-3"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#编写类postman页面-3"}},[t._v("#")]),t._v(" 编写类postman页面(3)")]),t._v(" "),r("h3",{attrs:{id:"回顾"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#回顾"}},[t._v("#")]),t._v(" 回顾")]),t._v(" "),r("p",[t._v("记得上一节我们编写了postman的中间部分，其实还有header部分的一些表单数据没有编写完成，今天我们就尽量完成它并且尝试跑一个小小的demo。")]),t._v(" "),r("h3",{attrs:{id:"寻找可编辑表格组件"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#寻找可编辑表格组件"}},[t._v("#")]),t._v(" 寻找可编辑表格组件")]),t._v(" "),r("p",[r("img",{attrs:{src:"https://static.pity.fun/picture/2021-3-13/1615644084094-image.png",alt:""}})]),t._v(" "),r("p",[t._v("可以看到这里比较简单，基本上就是2块: "),r("strong",[t._v("文字部分")]),t._v("和"),r("strong",[t._v("可编辑表格")])]),t._v(" "),r("p",[t._v("可编辑表格的话，我们可以自己写，也可以直接用现成的。我们为了傻瓜一点，就采用ant design pro封装好的高阶组件(意思是功能齐全，简单好用)")]),t._v(" "),r("p",[t._v("具体地址: "),r("a",{attrs:{href:"https://procomponents.ant.design/components/editable-table",target:"_blank",rel:"noopener noreferrer"}},[t._v("ProComponents"),r("OutboundLink")],1)]),t._v(" "),r("p",[r("img",{attrs:{src:"https://static.pity.fun/picture/2021-3-13/1615644225350-image.png",alt:""}})]),t._v(" "),r("p",[t._v("那么这个就是我们需要的，由于我们用的"),r("code",[t._v("JavaScript")]),t._v("而非"),r("code",[t._v("TypeScript")]),t._v("，所以呢我们需要复杂一点找到对应的源码:")]),t._v(" "),r("p",[r("img",{attrs:{src:"https://static.pity.fun/picture/2021-3-13/1615644301753-image.png",alt:"先展开代码然后点击这个js图标"}})]),t._v(" "),r("p",[r("img",{attrs:{src:"https://static.pity.fun/picture/2021-3-13/1615644329089-image.png",alt:""}})]),t._v(" "),r("p",[t._v("在弹出的网站就可以找到对应的JS代码了！")]),t._v(" "),r("p",[t._v("我们这个项目本来就带有了pro的组件，所以不需要额外安装了哈。(亲测新版本还有点问题)")]),t._v(" "),r("h3",{attrs:{id:"编写可编辑表格雏形"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#编写可编辑表格雏形"}},[t._v("#")]),t._v(" 编写可编辑表格雏形")]),t._v(" "),r("p",[t._v("首先呢，我们这个组件是postman组件，但是其实这个可编辑组件是可以和后面的"),r("code",[t._v("headers")]),t._v("标签进行"),r("strong",[t._v("复用")]),t._v("的，所以我们单独把这个组件抽出来封装。")]),t._v(" "),r("p",[t._v("新建"),r("code",[t._v("src/components/Table/EditableTable.jsx")])]),t._v(" "),r("p",[r("img",{attrs:{src:"https://static.pity.fun/picture/2021-3-13/1615648788658-image.png",alt:""}})]),t._v(" "),r("p",[t._v("代码基本上是复制过来的，但是我们抽取了几个重要的参数:")]),t._v(" "),r("ul",[r("li",[r("p",[t._v("columns")]),t._v(" "),r("p",[t._v("由于我们的每个表格的字段可能不一样，所以说我们不能写死")])]),t._v(" "),r("li",[r("p",[t._v("dataSource")]),t._v(" "),r("p",[t._v("实际数据，本来不是这样的，但是发现这个组件有点bug，让我有点"),r("strong",[t._v("小尴尬")])])]),t._v(" "),r("li",[r("p",[t._v("setDataSource")]),t._v(" "),r("p",[t._v("改变dataSource的方法")])]),t._v(" "),r("li",[r("p",[t._v("title")]),t._v(" "),r("p",[t._v("比如这里我们需要的title是"),r("strong",[t._v("Query Params")])])])]),t._v(" "),r("p",[r("img",{attrs:{src:"https://static.pity.fun/picture/2021-3-13/1615647405339-image.png",alt:""}})]),t._v(" "),r("p",[t._v("注意这里，这里我是从columns中拿到"),r("strong",[t._v("真实字段")]),t._v("，因为咱们还有其他字段比如后面的"),r("code",[t._v("删除")]),t._v("，拿到之后在用户点击"),r("code",[t._v("新增一行数据")]),t._v("的时候默认给字段加上值。")]),t._v(" "),r("h3",{attrs:{id:"引入表格组件并编写columns"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#引入表格组件并编写columns"}},[t._v("#")]),t._v(" 引入表格组件并编写columns")]),t._v(" "),r("p",[r("img",{attrs:{src:"https://static.pity.fun/picture/2021-3-13/1615648848051-image.png",alt:""}})]),t._v(" "),r("ul",[r("li",[t._v("columns")])]),t._v(" "),r("p",[r("img",{attrs:{src:"https://static.pity.fun/picture/2021-3-13/1615648876005-image.png",alt:""}})]),t._v(" "),r("p",[t._v("我设置了3个字段分别是"),r("strong",[t._v("KEY")]),t._v(","),r("strong",[t._v("VALUE")]),t._v(", "),r("strong",[t._v("DESCRIPTION")]),t._v("。与postman是保持一致的，然后最后一列我设置了一个图标(删除)，删除方法自己手动编写了（还是因为他有bug，无法删除）。因为我在官网没改源码的情况下也发现"),r("strong",[t._v("无法删除")]),t._v("。")]),t._v(" "),r("p",[t._v("看看效果:")]),t._v(" "),r("p",[r("img",{attrs:{src:"https://static.pity.fun/picture/2021-3-13/1615649005399-image.png",alt:"雏形是有了"}})]),t._v(" "),r("p",[t._v("其实postman做的更精致，下面的数据会改变url的内容。接下来我们也把这块实现了吧。")]),t._v(" "),r("h3",{attrs:{id:"改造url"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#改造url"}},[t._v("#")]),t._v(" 改造URL")]),t._v(" "),r("p",[t._v("现在我们有了params参数，那么我们的url就由2部分构成了:")]),t._v(" "),r("ul",[r("li",[t._v("url")]),t._v(" "),r("li",[t._v("params")])]),t._v(" "),r("p",[t._v("所以我们原先的url改变的时候如果有参数变动则需要修改参数项目，如果参数项目有变动也需要"),r("strong",[t._v("修改url")]),t._v("。")]),t._v(" "),r("p",[t._v("由于这个ProTable有一点点bug，笔者也搞了好久今晚，不过最后顺利完成了，大家pull最新的代码就可以看到效果了。可惜的是今天浪费太多时间了，就只简单对代码稍作描述了。")]),t._v(" "),r("p",[r("img",{attrs:{src:"https://static.pity.fun/picture/2021-3-14/1615652040093-image.png",alt:""}})]),t._v(" "),r("p",[t._v("这个表格组件有些变化:")]),t._v(" "),r("ul",[r("li",[t._v("把正在编辑的key和修改可编辑key的方法抽离出来了")]),t._v(" "),r("li",[t._v("extra函数用来在表格数据变动的时候做一些额外的变动，因为表格变化我们得去更新url")])]),t._v(" "),r("h4",{attrs:{id:"拼接url的方法"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#拼接url的方法"}},[t._v("#")]),t._v(" 拼接url的方法")]),t._v(" "),r("p",[r("img",{attrs:{src:"https://static.pity.fun/picture/2021-3-14/1615652125572-image.png",alt:""}})]),t._v(" "),r("p",[t._v("url的规则是 http://www.xxx.com + ?参数1=值&参数2=值2")]),t._v(" "),r("p",[t._v("所以第一个参数用?隔开，后面都是用&，代码写的很清楚了。")]),t._v(" "),r("h4",{attrs:{id:"拆解url的方法"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#拆解url的方法"}},[t._v("#")]),t._v(" 拆解url的方法")]),t._v(" "),r("p",[r("img",{attrs:{src:"https://static.pity.fun/picture/2021-3-14/1615652232006-image.png",alt:""}})]),t._v(" "),r("p",[t._v("这里写的"),r("strong",[t._v("比较复杂")]),t._v("，首先判断url里面有无参数，没有的话就把表单数据清空。接着就是取url的数据组成新的表单。但是表单的每一行是用时间区别的，这里js执行太快，所以我以数组索引+时间+10的方式，就算now全都一样，也没关系，因为索引肯定不一样，避免了一下子"),r("strong",[t._v("添加多行")]),t._v("的问题（当然你们是看不到这个问题的）。")]),t._v(" "),r("h4",{attrs:{id:"删除参数"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#删除参数"}},[t._v("#")]),t._v(" 删除参数")]),t._v(" "),r("p",[r("img",{attrs:{src:"https://static.pity.fun/picture/2021-3-14/1615652384201-image.png",alt:""}})]),t._v(" "),r("p",[t._v("删除参数的时候也重新拼接url给url输入框")]),t._v(" "),r("h4",{attrs:{id:"输入框url变化也改变参数表格"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#输入框url变化也改变参数表格"}},[t._v("#")]),t._v(" 输入框url变化也改变参数表格")]),t._v(" "),r("p",[r("img",{attrs:{src:"https://static.pity.fun/picture/2021-3-14/1615652435951-image.png",alt:""}})]),t._v(" "),r("h4",{attrs:{id:"新增了一些变量和set变量的方法"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#新增了一些变量和set变量的方法"}},[t._v("#")]),t._v(" 新增了一些变量和set变量的方法")]),t._v(" "),r("p",[r("img",{attrs:{src:"https://static.pity.fun/picture/2021-3-14/1615652457560-image.png",alt:""}})]),t._v(" "),r("p",[t._v("文件总体代码可以去github看，这里篇幅有限就不贴了。")]),t._v(" "),r("h3",{attrs:{id:"最终效果"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#最终效果"}},[t._v("#")]),t._v(" 最终效果")]),t._v(" "),r("p",[t._v("找了个截图软件，让大家看看效果吧，晚安。")]),t._v(" "),r("p",[r("img",{attrs:{src:"https://static.pity.fun/picture/2021-3-14/1615652971962-dd.gif",alt:""}})]),t._v(" "),r("h2",{attrs:{id:"广告时间"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#广告时间"}},[t._v("#")]),t._v(" 广告时间")]),t._v(" "),r("p",[r("em",[t._v("预览地址:")]),t._v(" "),r("a",{attrs:{href:"http://47.112.32.195/",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://47.112.32.195/"),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("后端代码地址: "),r("a",{attrs:{href:"https://github.com/wuranxu/pity",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/wuranxu/pity"),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("前端代码地址: "),r("a",{attrs:{href:"https://github.com/wuranxu/pityWeb",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/wuranxu/pityWeb"),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("欢迎关注公众号"),r("strong",[t._v("测试开发入坑")]),t._v("，还有加群一起讨论相关问题呀！如果群二维码过期了，可以加我个人微信: "),r("code",[t._v("wuranxu")]),t._v(" 我拉你进群~")]),t._v(" "),r("p",[r("img",{attrs:{src:"https://static.pity.fun/picture/2021-3-10/1615391632083-image.png",alt:""}})]),t._v(" "),r("p",[r("img",{attrs:{src:"https://static.pity.fun/picture/2021-3-10/1615390951439-image.png",alt:""}})])])}),[],!1,null,null,null);r.default=_.exports}}]);